
@{
    ViewBag.Title = "Car Loan";
}

<h2>Car Loan</h2>

<div class="row">
    <div class="col-md-8 col-md-offset-2">
        <div class="panel panel-default">
            <div class="panel-heading">
                <strong>Car Loan Information</strong>
            </div>
            <div class="panel-body">
                <form class="form-horizontal">
                    @*<div class="form-group">
                            <label class="col-md-3 control-label" for="month">Loan Date </label>
                            <div class="col-md-2">
                                <select class="form-control input-sm" id="month">
                                    <option label="Jan" value="1" selected="selected">Jan</option>
                                    <option label="Feb" value="2">Feb</option>
                                    <option label="Mar" value="3">Mar</option>
                                    <option label="Apr" value="4">Apr</option>
                                    <option label="May" value="5">May</option>
                                    <option label="Jun" value="6">Jun</option>
                                    <option label="Jul" value="7">Jul</option>
                                    <option label="Aug" value="8">Aug</option>
                                    <option label="Sep" value="9">Sep</option>
                                    <option label="Oct" value="10">Oct</option>
                                    <option label="Nov" value="11">Nov</option>
                                    <option label="Dec" value="12">Dec</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select class="form-control input-sm" id="year">
                                    <option label="1990" value="1990">1990</option>
                                    <option label="1991" value="1991">1991</option>
                                    <option label="1992" value="1992">1992</option>
                                    <option label="1993" value="1993">1993</option>
                                    <option label="1994" value="1994">1994</option>
                                    <option label="1995" value="1995">1995</option>
                                    <option label="1996" value="1996">1996</option>
                                    <option label="1997" value="1997">1997</option>
                                    <option label="1998" value="1998">1998</option>
                                    <option label="1999" value="1999">1999</option>
                                    <option label="2000" value="2000">2000</option>
                                    <option label="2001" value="2001">2001</option>
                                    <option label="2002" value="2002">2002</option>
                                    <option label="2003" value="2003">2003</option>
                                    <option label="2004" value="2004">2004</option>
                                    <option label="2005" value="2005">2005</option>
                                    <option label="2006" value="2006">2006</option>
                                    <option label="2007" value="2007">2007</option>
                                    <option label="2008" value="2008">2008</option>
                                    <option label="2009" value="2009">2009</option>
                                    <option label="2010" value="2010">2010</option>
                                    <option label="2011" value="2011">2011</option>
                                    <option label="2012" value="2012">2012</option>
                                    <option label="2013" value="2013">2013</option>
                                    <option label="2014" value="2014">2014</option>
                                    <option label="2015" value="2015" selected="selected">2015</option>
                                    <option label="2016" value="2016">2016</option>
                                </select>
                            </div>
                        </div>*@
                    <div class="form-group">
                        <label class="col-md-3 control-label" for="date">Loan Date</label>
                        <div class="col-md-4">
                            <div class="input-group">
                                <input type="date" class="form-control" id="date" onchange="updatePayment()">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label" for="amount">Car Loan Amount</label>
                        <div class="col-md-4">
                            <div class="input-group">
                                <div class="input-group-addon">$</div>
                                <input type="text" class="form-control" id="amount" placeholder="Car Loan Amount ($)" onkeyup="updatePayment()">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label" for="term">Loan Term</label>
                        <div class="col-md-4">
                            <div class="input-group">
                                <input type="text" class="form-control" id="term" placeholder="Term (Years)" onkeyup="updatePayment()">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label" for="rate">Interest Rate</label>
                        <div class="col-md-4">
                            <div class="input-group">
                                <input type="text" class="form-control" id="rate" placeholder="Interest Rate (%)" onkeyup="updatePayment()">
                            </div>
                        </div>
                    </div>

                </form>
            </div>

        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-8 col-md-offset-2">
        <div class="panel panel-default hide" id="payments_panel">
            <div class="panel-heading">
                <strong>Car Loan Payments</strong>
            </div>
            <div class="panel-body">
                <form class="form-horizontal">
                    <div class="form-group">
                        <label class="col-md-3 control-label" for="payment">Monthly Payment</label>
                        <div class="col-md-4">
                            <div class="input-group">
                                <div class="input-group-addon">$</div>
                                <input type="text" class="form-control disabled" id="payment">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label" for="total_interest">Total Interest</label>
                        <div class="col-md-4">
                            <div class="input-group">
                                <div class="input-group-addon">$</div>
                                <input type="text" class="form-control disabled" id="total_interest">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label" for="total_cost">Total Cost</label>
                        <div class="col-md-4">
                            <div class="input-group">
                                <div class="input-group-addon">$</div>
                                <input type="text" class="form-control disabled" id="total_cost">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-8 col-md-offset-2">
        <div class="panel panel-default hide" id="table_panel">
            <div class="panel-heading">
                <strong>Amortization Table</strong>
            </div>
            <div class="panel-body">

                <table class="table table-condensed table-responsive text-right" id="amort"></table>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">



    function updatePayment() {

        var date = $('#date').val();
        var amount = $('#amount').val();
        var term = $('#term').val();
        var rate = $('#rate').val();
        //var month = $('#month').val();
        //var year = $('#year').val();

        var d = new Date(date);
        var month = d.getUTCMonth() + 1;
        var year = d.getUTCFullYear();

        if (!(amount && term && rate))
            return;
        var payment = carLoanMonthlyPayment(amount, term, rate);
        var p = parseFloat(amount);
        var n = parseFloat(term);

        var interest = (payment * (n * 12) - p);
        var total = (p + interest);

        //set fields
        $('#payment').val(payment.toFixed(2));
        $('#amort').html(renderAmortTable(amount, term, rate, month, year));
        $('#total_interest').val(interest.toFixed(2));
        $('#total_cost').val(total.toFixed(2));

        $('#payments_panel').removeClass('hide');
        $('#table_panel').removeClass('hide');
    }

</script>